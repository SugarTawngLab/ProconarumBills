<mvc:View controllerName="ns.proconarumbills.controller.CreateRequest"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:uxap="sap.uxap"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.ui.layout.form"
    xmlns="sap.m"
    xmlns:upload="sap.m.upload"
    xmlns:goals="sap.uxap.sample.SharedBlocks.goals"
    xmlns:personal="sap.uxap.sample.SharedBlocks.personal"
    xmlns:employment="sap.uxap.sample.SharedBlocks.employment" height="100%">
    <Page id="auditScoreDetailPage" showHeader="false" enableScrolling="true">
        <content>
            <uxap:ObjectPageLayout id="ObjectPageLayout" showTitleInHeaderContent="true" showEditHeaderButton="false" editHeaderButtonPress="handleEditBtnPress" upperCaseAnchorBar="false" showFooter="true">
                <uxap:headerTitle>
                    <uxap:ObjectPageDynamicHeaderTitle id="ObjectPageDynamicHeaderTitle">
                        <uxap:expandedHeading>
                            <Title id="Title" text="{i18n>createExpenseRequest}" wrapping="true"/>
                        </uxap:expandedHeading>
                        <uxap:snappedHeading>
                            <FlexBox id="FlexBox" fitContainer="true" alignItems="Center">
                                <Title id="Title2" text="{i18n>createExpenseRequest}" wrapping="true" />
                            </FlexBox>
                        </uxap:snappedHeading>
                    </uxap:ObjectPageDynamicHeaderTitle>
                </uxap:headerTitle>

                <uxap:sections>
                    <uxap:ObjectPageSection titleUppercase="false" id="goalsSection" title="{i18n>requestHeader}">
                        <uxap:subSections>
                            <uxap:ObjectPageSubSection id="goalsSectionSS1">
                            <VBox id="VBoxFormContainer" width="100%">
                                <f:SimpleForm id="editAuditScoreBasicData" editable="true" layout="ColumnLayout" labelSpanXL="2" labelSpanL="2" labelSpanM="2" labelSpanS="12" adjustLabelSpan="false" emptySpanXL="2" emptySpanL="2" emptySpanM="2" emptySpanS="2" columnsXL="2" columnsL="2" columnsM="2" singleContainerFullSize="false">
                                    <f:content>
                                        <Label id="Label13" text="Request Description" required="true"/>
                                        <Input id="requestDescription"
                                            placeholder="Transfer Office"
                                            ariaLabelledBy="InputNumberLabel"
                                            value="{auditScoreItemModel>/auditScore}"
                                            class="sapUiSmallMarginBottom"
                                            change="onBasicDataValidation" 
                                            editable="true" />

                                        <Label id="Label3" text="Currency" required="true"/>
                                        <Select id="currency" 
                                                editable="true"
                                                class="sapUiSmallMarginBottom">
                                            <core:Item id="currencyItems" key="USD" text="USD" />
                                            <core:Item id="currencyItems1" key="VND" text="VND" />
                                            <core:Item id="currencyItems2" key="EUR" text="EUR" />
                                            <core:Item id="currencyItems3" key="JPY" text="JPY" />
                                        </Select>

                                        <Label id="Label2" text="Priority" required="false"/>
                                        <Select id="auditScoreDetailAuditLabel" 
                                                editable="true"
                                                class="sapUiSmallMarginBottom">
                                            <core:Item id="currencyItems4" key="Draft" text="Draft" />
                                            <core:Item id="currencyItems5" key="ReOpen" text="ReOpen" />
                                            <core:Item id="currencyItems6" key="InProgress" text="InProgress" />
                                            <core:Item id="currencyItems7" key="Approved" text="Approved" />
                                            <core:Item id="currencyItems8" key="Rejected" text="Rejected" />
                                            <core:Item id="currencyItems9" key="Completed" text="Completed" />
                                        </Select>

                                        <Label id="Label1" text="Due date" required="true" />
                                        <DatePicker id="auditScoreDetailValidTo" change="onBasicDataValidation" 
                                        editable="true"
                                        placeholder="23/04/2025" value="{
                                                            'path':'auditScoreItemModel>/validTo',
                                                            'type':'sap.ui.model.type.Date'
                                                        }" class="sapUiSmallMarginBottom" valueState="{fieldValueStateModel>/auditScoreValidToStage}"/>
                                        <Button id="Button1" width="0.5rem" icon="sap-icon://information" type="Transparent" press="onShowValidInputRequiredInformation"/>
                                    </f:content>
                                </f:SimpleForm>

                                <f:SimpleForm id="SimpleForm" editable="true" layout="ResponsiveGridLayout" >
                                    <f:content>
                                        <Label id="Label20" text="Request Information" required="true" />
                                        <TextArea editable="true"
                                                id="auditScoreDetailLongText" value="{auditScoreItemModel>/longText}" width="100%" rows="6" placeholder="Describe more detail your request" maxLength="5000"/>
                                    </f:content>
                                </f:SimpleForm>
                            </VBox>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>

                    <uxap:ObjectPageSection id="ObjectPageSection3" titleUppercase="false" title="{i18n>requestItems}">
                        <uxap:subSections>
                        	<uxap:ObjectPageSubSection id="ObjectPageSubSection2" >
                                <Table 
                                    busyIndicatorDelay="0" 
                                    id="idExpenseItemsTable" 
                                    growing="true"
                                    growingThreshold="100"
                                    growingScrollToLoad="true"
                                    updateFinished="setPoTableHeader"
                                    mode="MultiSelect"
                                    sticky="ColumnHeaders,HeaderToolbar"
                                    width="auto"
                                    items="{path: 'ExpenseItems>/items'}"
                                    itemPress=".onItemPress"
                                    >
                                    <headerToolbar>
                                        <OverflowToolbar id="OverflowToolbar3">
                                            <Title id="idTableHeaderText" text="" level="H2"/>
                                            <ToolbarSpacer id="toolbarSpacer1" />
                                            <Button id="_IDGenButton" text="Add Item" icon="sap-icon://add" press="onAddRow" />
                                            <Button id="btnDeleteExpenseItems" text="Delete" icon="sap-icon://delete" press=".onDelete" />
                                        </OverflowToolbar>
                                    </headerToolbar>
                                    <columns>
                                        <Column id="supplierId" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title12" text="Item Description" class="fontWeightBold" />
                                        </Column>

                                        <Column id="supplierName" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title13" text="Amount" class="fontWeightBold" />
                                        </Column>

                                        <Column id="activityPriorityId" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title14" text="Item Category" class="fontWeightBold" />
                                        </Column>

                                        <Column id="statusId" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title15" text="Item Date" class="fontWeightBold" />
                                        </Column>

                                        <Column id="pendingSteps" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title16" text="Vendor" class="fontWeightBold" />
                                        </Column>

                                        <Column id="submittedSteps" hAlign="Begin" vAlign="Middle" minScreenWidth="Desktop" demandPopin="true">
                                            <Text id="Title17" text="Remark" class="fontWeightBold" />
                                        </Column>

                                    </columns>
                                    <items>
                                        <ColumnListItem id="columnListItemActivity">
                                            <cells>
                                                <Input id="_IDGenInput1" value="{ExpenseItems>description}" />
                                                <Input id="_IDGenInput2" value="{ExpenseItems>category}" />
                                                <DatePicker id="_IDGenDatePicker" value="{ExpenseItems>billDate}" displayFormat="yyyy-MM-dd" />
                                                <Input id="_IDGenInput3" value="{ExpenseItems>paymentMethod}" />
                                                <Input id="_IDGenInput4" value="{ExpenseItems>ammount}" />
                                                <Input id="_IDGenInput5" value="{ExpenseItems>remark}" />
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>

                    <uxap:ObjectPageSection id="ObjectPageSection" titleUppercase="false" title="{i18n>requestAttachments}">
                        <uxap:subSections>
                            <uxap:ObjectPageSubSection id="ObjectPageSubSection" >
                                <upload:UploadSet   id="AuditScoreDetailUploadCollection" 
                                                    mode = "None" 
                                                    instantUpload="true"  
                                                    terminationEnabled="true" 
                                                    fileTypeMismatch="onTypeMissmatch" 
                                                    fileTypes="txt,doc,pdf,xlsx,png,jpg" 
                                                    sameFilenameAllowed="true" 
                                                    items="{AttachmentItems>/attachments}" 
                                                    fileNameLengthExceeded="onFileNameLength" 
                                                    fileSizeExceeded="onFileSizeExceeded" 
                                                    beforeItemEdited="onHandleBeforeEdit" 
                                                    afterItemEdited="onHandleAfterEditFile" 
                                                    beforeItemRemoved="onHandleBeforeRemoveFileUploadForAuditScore" 
                                                    afterItemRemoved="onHandleAfterRemoveFileUploadForAuditScore" 
                                                    afterItemAdded="onUploadItemAttachments"
                                                    uploadCompleted="onUploadCompleted"
                                                    uploadEnabled="true">
                                    <upload:items>
                                        <upload:UploadSetItem id="UploadSetItem" fileName="{AttachmentItems>fileName}" 
                                                                openPressed="onDownloadAttachment" 
                                                                url="#"
                                                                enabledRemove="true"
                                                                visibleEdit="false" 
                                                                visibleRemove="true">
                                                <upload:statuses>
                                                    <ObjectStatus id="ObjectStatus2" title="{AttachmentItems>uploadedBy}" text="{AttachmentItems>createdBy}" active="false"/>
                                                    <ObjectStatus id="ObjectStatus3" title="{AttachmentItems>uploadedOn}" 
                                                                    text="{
                                                                        path: 'AttachmentItems>createdAt',
                                                                        type: 'sap.ui.model.odata.type.DateTimeOffset',
                                                                        constraints: {
                                                                            precision: 3,
                                                                            v4: true
                                                                        }
                                                                    }" active="false"/>
                                                </upload:statuses>                
                                        </upload:UploadSetItem>
                                    </upload:items>
                                </upload:UploadSet>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>

                    <uxap:ObjectPageSection id="ObjectPageSection2" titleUppercase="false" title="{i18n>requesterNote}">
                        <uxap:subSections>
                            <uxap:ObjectPageSubSection id="ObjectPageSubSection4">
                                <f:SimpleForm id="SimpleForm2" editable="true" layout="ResponsiveGridLayout" >
                                    <f:content>
                                        <TextArea editable="true"
                                                  id="expenseRequestDetailLongText2" value="{expenseRequestItemModel>/longText}" width="100%" rows="6" placeholder="{i18n>requesterNoteContent}" maxLength="5000"/>
                                    </f:content>
                                </f:SimpleForm>
                            </uxap:ObjectPageSubSection>
                        </uxap:subSections>
                    </uxap:ObjectPageSection>
                </uxap:sections>

                <uxap:footer>
                    <OverflowToolbar id="overflowToolbarFooter">
                        <ToolbarSpacer id="toolbarSpacerFooter" />
                        <Button id="btnSaveDraftExpenseRequest" type="Default" text="Save Draft" press="onSaveDraftExpenseRequest"
                            enabled="true"
                            visible="true" />
                        <Button id="btnSubmitExpenseRequest" type="Emphasized" text="Submit" press="onSubmitExpenseRequest"
                            enabled="true"
                            visible="true" />
                        <Button id="btnCancelExpenseRequest" type="Default" text="Cancel" press="onBackToExpenseRequestList" />
                    </OverflowToolbar>
                </uxap:footer>
            </uxap:ObjectPageLayout>
        </content>
    </Page>
</mvc:View>